M·ª•c ti√™u Ph·∫ßn 3
Hi·ªÉn th·ªã th√¥ng tin v√≠ ƒëi·ªán t·ª≠:

S·ªë d∆∞ (b·∫±ng s·ªë & ch·ªØ)

L·ªãch s·ª≠ giao d·ªãch (tuy·ªÉn h·ªçc sinh, th∆∞·ªüng bonus)

Hi·ªÉn th·ªã s∆° ƒë·ªì tuy·∫øn d∆∞·ªõi:

Danh s√°ch c√°c th√†nh vi√™n m√† ng∆∞·ªùi d√πng gi·ªõi thi·ªáu

C√≥ th·ªÉ ph√¢n t·∫ßng c·∫•p 1 ‚Üí c·∫•p 2

Giao di·ªán r√µ r√†ng, d·ªÖ d√πng

üîß B·ªï sung v√†o models.py
Th√™m quan h·ªá tuy·∫øn d∆∞·ªõi cho Member:

python
Sao ch√©p
Ch·ªânh s·ª≠a
class Member(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    full_name = db.Column(db.String(100), nullable=False)
    phone = db.Column(db.String(20), nullable=False, unique=True)
    email = db.Column(db.String(100), nullable=False, unique=True)
    password = db.Column(db.String(200), nullable=False)
    role = db.Column(db.String(20), nullable=False)  # 'giaovien' | 'phuhuynh'
    industry = db.Column(db.String(100))
    address = db.Column(db.String(200))
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    wallet = db.relationship('Wallet', backref='member', uselist=False)
    referrer_id = db.Column(db.Integer, db.ForeignKey('member.id'))  # ng∆∞·ªùi gi·ªõi thi·ªáu
    referred = db.relationship('Member', backref=db.backref('referrer', remote_side=[id]), lazy='dynamic')
‚úÖ H√†m chuy·ªÉn s·ªë ‚Üí ch·ªØ ti·∫øng Vi·ªát (num2vn)
python
Sao ch√©p
Ch·ªânh s·ª≠a
def num2vn(n):
    from num2words import num2words
    return num2words(n, lang='vi').capitalize() + ' ƒë·ªìng'
‚ö†Ô∏è C√†i th√™m th∆∞ vi·ªán num2words v√†o requirements.txt

üìÑ Route hi·ªÉn th·ªã v√≠
python
Sao ch√©p
Ch·ªânh s·ª≠a
@app.route('/wallet/<int:member_id>')
def view_wallet(member_id):
    member = Member.query.get(member_id)
    wallet = member.wallet
    balance_text = num2vn(wallet.balance)
    
    # L·∫•y danh s√°ch tuy·∫øn d∆∞·ªõi (c·∫•p 1)
    downline = Member.query.filter_by(referrer_id=member.id).all()

    return render_template('wallet.html', member=member, wallet=wallet, balance_text=balance_text, downline=downline)
üìÑ Template wallet.html
html
Sao ch√©p
Ch·ªânh s·ª≠a
<h2>üëõ V√≠ c√° nh√¢n c·ªßa {{ member.full_name }}</h2>
<p><b>S·ªë d∆∞:</b> {{ wallet.balance | format }} VND</p>
<p><b>B·∫±ng ch·ªØ:</b> {{ balance_text }}</p>

<h3>üìú L·ªãch s·ª≠ giao d·ªãch:</h3>
<pre>{{ wallet.history }}</pre>

<h3>üå± Tuy·∫øn d∆∞·ªõi (F1):</h3>
<ul>
  {% for m in downline %}
    <li>{{ m.full_name }} ({{ m.role }})</li>
  {% else %}
    <li>Ch∆∞a c√≥ tuy·∫øn d∆∞·ªõi n√†o</li>
  {% endfor %}
</ul>
‚úÖ K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c
 Hi·ªÉn th·ªã r√µ s·ªë ti·ªÅn (b·∫±ng s·ªë + ch·ªØ)

 Hi·ªÉn th·ªã l·ªãch s·ª≠ c·ªông ti·ªÅn

 Hi·ªÉn th·ªã danh s√°ch tuy·∫øn d∆∞·ªõi F1 (c√≥ th·ªÉ m·ªü r·ªông c·∫•p 2)

